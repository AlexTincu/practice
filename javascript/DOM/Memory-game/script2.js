const library = {
  pokemon: [
    "https://res.cloudinary.com/beumsk/image/upload/v1547980025/memory/Pokemon/Bulbasaur.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980083/memory/Pokemon/Charmander.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980101/memory/Pokemon/Squirtle.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980116/memory/Pokemon/Pikachu.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980129/memory/Pokemon/Mewtwo.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980142/memory/Pokemon/Mew.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980154/memory/Pokemon/Articuno.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980164/memory/Pokemon/Zapdos.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980175/memory/Pokemon/Moltres.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980186/memory/Pokemon/Eevee.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980025/memory/Pokemon/Bulbasaur.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980083/memory/Pokemon/Charmander.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980101/memory/Pokemon/Squirtle.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980116/memory/Pokemon/Pikachu.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980129/memory/Pokemon/Mewtwo.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980142/memory/Pokemon/Mew.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980154/memory/Pokemon/Articuno.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980164/memory/Pokemon/Zapdos.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980175/memory/Pokemon/Moltres.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980186/memory/Pokemon/Eevee.png",
  ],
  starwars: [
    "https://res.cloudinary.com/beumsk/image/upload/v1547980981/memory/starwars/anakin%20skywalker.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981009/memory/starwars/luke%20skywalker.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981022/memory/starwars/Obi%20wann.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981054/memory/starwars/Han%20solo.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981074/memory/starwars/chewbacca.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981095/memory/starwars/yoda.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981117/memory/starwars/dark%20sidious.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981141/memory/starwars/dark%20vador.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981165/memory/starwars/padme.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981190/memory/starwars/leia.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547980981/memory/starwars/anakin%20skywalker.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981009/memory/starwars/luke%20skywalker.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981022/memory/starwars/Obi%20wann.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981054/memory/starwars/Han%20solo.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981074/memory/starwars/chewbacca.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981095/memory/starwars/yoda.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981117/memory/starwars/dark%20sidious.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981141/memory/starwars/dark%20vador.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981165/memory/starwars/padme.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981190/memory/starwars/leia.jpg",
  ],
  lotr: [
    "https://res.cloudinary.com/beumsk/image/upload/v1547981408/memory/lotr/gandalf.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981438/memory/lotr/sauron.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981469/memory/lotr/Aragorn.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981501/memory/lotr/legolas.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981535/memory/lotr/Gimli.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981603/memory/lotr/golum.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981645/memory/lotr/sam.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981686/memory/lotr/saroumane.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981738/memory/lotr/bilbo.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981802/memory/lotr/frodo.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981408/memory/lotr/gandalf.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981438/memory/lotr/sauron.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981469/memory/lotr/Aragorn.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981501/memory/lotr/legolas.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981535/memory/lotr/Gimli.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981603/memory/lotr/golum.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981645/memory/lotr/sam.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981686/memory/lotr/saroumane.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981738/memory/lotr/bilbo.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547981802/memory/lotr/frodo.jpg",
  ],
  disney: [
    "https://res.cloudinary.com/beumsk/image/upload/v1547982044/memory/disney/mickey.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982088/memory/disney/mowgli.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982610/memory/disney/tarzan.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982620/memory/disney/simba.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982628/memory/disney/aladin.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982636/memory/disney/blanche%20neige.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982644/memory/disney/alice.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982653/memory/disney/peter%20pan.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982663/memory/disney/pinocchio.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982738/memory/disney/raiponce.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982044/memory/disney/mickey.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982088/memory/disney/mowgli.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982610/memory/disney/tarzan.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982620/memory/disney/simba.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982628/memory/disney/aladin.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982636/memory/disney/blanche%20neige.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982644/memory/disney/alice.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982653/memory/disney/peter%20pan.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982663/memory/disney/pinocchio.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982738/memory/disney/raiponce.jpg",
  ],
  pixar: [
    "https://res.cloudinary.com/beumsk/image/upload/v1547982971/memory/pixar/up.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982987/memory/pixar/buzz.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983000/memory/pixar/woody.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983016/memory/pixar/Remy.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983032/memory/pixar/Mike.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983077/memory/pixar/Nemo.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983114/memory/pixar/wall-e.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983169/memory/pixar/Mr-Incredible.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983381/memory/pixar/sully.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983403/memory/pixar/flash%20mcqueen.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982971/memory/pixar/up.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547982987/memory/pixar/buzz.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983000/memory/pixar/woody.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983016/memory/pixar/Remy.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983032/memory/pixar/Mike.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983077/memory/pixar/Nemo.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983114/memory/pixar/wall-e.png",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983169/memory/pixar/Mr-Incredible.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983381/memory/pixar/sully.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547983403/memory/pixar/flash%20mcqueen.jpg",
  ],
  harrypotter: [
    "https://res.cloudinary.com/beumsk/image/upload/v1547998926/memory/harrypotter/harry.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547998958/memory/harrypotter/ron.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547998992/memory/harrypotter/hermione.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999106/memory/harrypotter/dumbledore.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999032/memory/harrypotter/malfoy.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999143/memory/harrypotter/voldemort.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999401/memory/harrypotter/rogue.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999196/memory/harrypotter/hagrid.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999271/memory/harrypotter/sirius.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999577/memory/harrypotter/neville.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547998926/memory/harrypotter/harry.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547998958/memory/harrypotter/ron.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547998992/memory/harrypotter/hermione.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999106/memory/harrypotter/dumbledore.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999032/memory/harrypotter/malfoy.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999143/memory/harrypotter/voldemort.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999401/memory/harrypotter/rogue.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999196/memory/harrypotter/hagrid.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999271/memory/harrypotter/sirius.jpg",
    "https://res.cloudinary.com/beumsk/image/upload/v1547999577/memory/harrypotter/neville.jpg",
  ],
};

let images = [];
let tempElem1 = ""; // primul element afisat
let tempElem2 = ""; // al doilea element afisat
let click = -1; // primul sau al doilea click, dupa care se reseteaza la -1
let win = 0; // primesti un punct cand ghicesti o pereche, la 10 se termina jocul
let score = 0; // primesti 10 puncte cand ghicesti o pereche, pierzi 2 cand nu nimeresti
let time = 0; // timpul in secunde scurs de la inceperea jocului
let timer; // timerul rezultat de setInterval pentru a-l opri cand jocul e gata

const preElem = document.querySelector("#pre");
const themesElem = document.querySelector("#themes");
const boxElems = document.getElementsByClassName("box");
const mainElem = document.querySelector(".main");
const timeElem = document.querySelector("#time");
const scoreElem = document.querySelector("#score");
const postElem = document.querySelector("#post");
const finalElem = document.querySelector("#final");
const againElem = document.querySelector("#again");

// initiate the game with chosen theme
themesElem.addEventListener("click", function (e) {
  // early return
  if (!e.target.classList.contains("themes")) return;

  activateTheme(e.target.id);
  e.target.parentElement.classList.add("hidden");
});

function activateTheme(theme) {
  images = library[theme];

  // insert images in memory game
  for (let i = 0; i < 20; i++) {
    var rand = Math.floor(Math.random() * images.length);
    boxElems[i].innerHTML = `<img src="${images[rand]}" class='hidden'>`;
    images.splice(rand, 1); // elimin imaginea de pe pozitia rand
  }
}

mainElem.addEventListener("click", play);

function play(e) {
  // daca nu dau click pe un box playabil, nu iau in considerare clickul
  if (!e.target.classList.contains("play")) return;

  // nu mai pot da click pe el
  e.target.classList.remove("play");

  // afisez imaginea pe care am dat click
  e.target.firstChild.classList.remove("hidden");

  // start timer daca nu e deja pornit
  if (timer === undefined) {
    timer = setInterval(() => {
      time++;
      timeElem.innerHTML = time;
    }, 1000);
  }

  // primul click
  if (click < 1) {
    click = 1;
    tempElem1 = e.target;
  } else {
    // al doilea click
    tempElem2 = e.target;

    if (tempElem1.firstChild.src === tempElem2.firstChild.src) {
      // same image
      score += 10;
      win++;
    } else {
      if (score > 0) {
        score -= 2;
      }
      mainElem.removeEventListener("click", play);

      setTimeout(() => {
        // boxurile devin bune de ghicit din nou
        tempElem1.classList.add("play");
        tempElem2.classList.add("play");

        // imaginile devin ascunse
        tempElem1.firstChild.classList.add("hidden");
        tempElem2.firstChild.classList.add("hidden");
        mainElem.addEventListener("click", play);
      }, 500);
    }

    click = 0;
    scoreElem.innerHTML = score;
  }

  if (win === 10) {
    clearInterval(timer);
    postElem.classList.remove("hidden");
    finalElem.innerHTML = `You won ${score} points <br> in ${time} seconds`;
  }
}

againElem.addEventListener("click", reset);

function reset(e) {
  tempElem1 = "";
  tempElem2 = "";
  click = -1;
  win = 0;
  score = 0;
  time = 0;

  timeElem.textContent = time;
  scoreElem.textContent = score;

  // ascund imaginile
  for (let i = 0; i < 20; i++) {
    boxElems[i].classList.add("play");
    boxElems[i].firstChild.classList.add("hidden");
  }

  // fereastra cu teme o facem vizibila
  themesElem.parentElement.classList.remove("hidden");
  // fereastra curenta o inchidem
  postElem.classList.add("hidden");
}
